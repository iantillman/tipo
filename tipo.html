<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Tipo — Minimal Text Editor</title>
  <meta name="description" content="Tipo is a simple, minimalist web-based text editor in a single HTML file." />
  <style>
    :root {
      --bg: #f8fbff;
      --fg: #0b2a4a;
      --muted: #6e87a0;
      --primary: #2563eb; /* blue-600 */
      --primary-500: #3b82f6; /* blue-500 */
      --primary-400: #60a5fa; /* blue-400 */
      --ring: rgba(37, 99, 235, 0.25);
      --panel: rgba(255,255,255,0.75);
      --panel-border: rgba(37, 99, 235, 0.15);
      --shadow: 0 10px 30px rgba(37, 99, 235, 0.12);
    }

    html, body { height: 100%; }

    body {
      margin: 0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji";
      color: var(--fg);
      background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 40%, #bfdbfe 100%);
      display: grid;
      place-items: center;
    }

    .shell {
      width: min(1100px, 92vw);
      height: min(720px, 86vh);
      background: var(--panel);
      backdrop-filter: saturate(140%) blur(10px);
      border: 1px solid var(--panel-border);
      border-radius: 22px;
      box-shadow: var(--shadow);
      display: grid;
      grid-template-rows: auto 1fr auto;
      overflow: hidden;
    }

    .topbar {
      display: flex;
      align-items: center;
      gap: 14px;
      padding: 14px 16px;
      background: linear-gradient(180deg, rgba(255,255,255,0.9), rgba(255,255,255,0.65));
      border-bottom: 1px solid var(--panel-border);
    }

    .brand { display: flex; align-items: center; gap: 10px; font-weight: 700; letter-spacing: 0.3px; }
    .brand-badge {
      width: 28px; height: 28px; border-radius: 9px;
      background: radial-gradient(120% 120% at 10% 10%, var(--primary-400) 0%, var(--primary-500) 45%, var(--primary) 100%);
      box-shadow: inset 0 0 0 1px rgba(255,255,255,0.35), 0 6px 16px rgba(37, 99, 235, 0.25);
    }

    .gap { flex: 1; }

    .control { display: flex; align-items: center; gap: 10px; flex-wrap: wrap; }

    .btn {
      appearance: none; border: 1px solid var(--panel-border); background: white; color: var(--fg);
      font-weight: 600; padding: 10px 14px; border-radius: 12px; cursor: pointer;
      transition: transform 120ms ease, box-shadow 120ms ease; box-shadow: 0 2px 8px rgba(2, 6, 23, 0.06);
    }
    .btn:focus-visible { outline: none; box-shadow: 0 0 0 4px var(--ring); }
    .btn:hover { transform: translateY(-1px); }
    .btn.primary { background: linear-gradient(180deg, var(--primary-500), var(--primary)); color: white; border: 1px solid rgba(255,255,255,0.35); box-shadow: 0 6px 14px rgba(37, 99, 235, 0.35); }

    .filename { border: 1px solid var(--panel-border); background: white; padding: 10px 12px; border-radius: 12px; min-width: 180px; font-weight: 600; color: var(--fg); }
    .filename:focus { outline: none; box-shadow: 0 0 0 4px var(--ring); border-color: var(--primary-500); }

    .editor-wrap { position: relative; padding: 14px; }

    .editor {
      width: 100%; height: 100%; resize: none; border: 1px solid var(--panel-border); background: white; border-radius: 16px;
      padding: 18px 18px 28px 18px; font: 500 16px/1.6 ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      color: #0b1b2d; box-shadow: inset 0 2px 10px rgba(2, 6, 23, 0.03);
    }
    .editor:focus { outline: none; box-shadow: 0 0 0 6px var(--ring), inset 0 2px 10px rgba(2, 6, 23, 0.03); border-color: var(--primary-500); }

    .statusbar { display: flex; justify-content: space-between; align-items: center; gap: 10px; padding: 10px 14px; border-top: 1px solid var(--panel-border); background: linear-gradient(0deg, rgba(255,255,255,0.9), rgba(255,255,255,0.6)); font-size: 12px; color: var(--muted); }

    .kbd { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; background: #eef2ff; border: 1px solid #c7d2fe; border-bottom-width: 2px; border-radius: 6px; padding: 2px 6px; color: #1e3a8a; }

    @media (max-width: 640px) { .filename { min-width: 140px; } .btn { padding: 9px 12px; } .editor { font-size: 15px; } }
  </style>
</head>
<body>
  <main class="shell" role="application" aria-label="Tipo — Minimal Text Editor">
    <header class="topbar">
      <div class="brand" aria-label="App brand">
        <div class="brand-badge" aria-hidden="true"></div>
        <span>Tipo</span>
      </div>
      <div class="gap"></div>
      <div class="control">
        <input id="filename" class="filename" type="text" value="untitled.txt" aria-label="File name" />
        <input id="file-input" type="file" accept=".txt,text/plain,.md,.csv,.log" hidden aria-label="Open local text file" />
        <button id="btn-open" class="btn" title="Open (Ctrl/⌘+O)">Open</button>
        <button id="btn-save" class="btn primary" title="Save (Ctrl/⌘+S)">Save</button>
        <button id="btn-clear" class="btn" title="New / Clear">New</button>
      </div>
    </header>

    <section class="editor-wrap">
      <textarea id="editor" class="editor" placeholder="Start typing…"></textarea>
    </section>

    <footer class="statusbar">
      <div id="status">Saved locally • Autosave on</div>
      <div>
        Shortcuts: <span class="kbd">Ctrl</span>/<span class="kbd">⌘</span> + <span class="kbd">S</span> to Save,
        <span class="kbd">Ctrl</span>/<span class="kbd">⌘</span> + <span class="kbd">O</span> to Open
      </div>
    </footer>
  </main>

  <script>
    (function () {
      const editor = document.getElementById('editor');
      const filename = document.getElementById('filename');
      const fileInput = document.getElementById('file-input');
      const btnOpen = document.getElementById('btn-open');
      const btnSave = document.getElementById('btn-save');
      const btnClear = document.getElementById('btn-clear');
      const status = document.getElementById('status');

      // Namespaced keys for Tipo
      const LS_KEY = 'tipo:v1:text';
      const LS_FILE = 'tipo:v1:filename';

      // Load from localStorage
      try {
        const saved = localStorage.getItem(LS_KEY);
        const savedName = localStorage.getItem(LS_FILE);
        if (saved !== null) editor.value = saved;
        if (savedName) filename.value = savedName;
      } catch (e) {
        console.warn('LocalStorage unavailable');
      }

      // Autosave
      let saveTimer;
      editor.addEventListener('input', () => {
        status.textContent = 'Editing…';
        clearTimeout(saveTimer);
        saveTimer = setTimeout(() => {
          try {
            localStorage.setItem(LS_KEY, editor.value);
            status.textContent = 'Saved locally • Autosave on';
          } catch (e) {
            status.textContent = 'Autosave unavailable';
          }
        }, 400);
      });

      // Persist filename
      filename.addEventListener('input', () => {
        try { localStorage.setItem(LS_FILE, filename.value); } catch {}
      });

      // Download helper
      function downloadText(name, content) {
        const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url; a.download = name || 'untitled.txt';
        document.body.appendChild(a); a.click(); a.remove();
        URL.revokeObjectURL(url);
      }

      // Save button
      btnSave.addEventListener('click', () => {
        const name = (filename.value || 'untitled.txt').trim();
        downloadText(name, editor.value);
        status.textContent = 'Downloaded to your device';
      });

      // Open button -> file input
      btnOpen.addEventListener('click', () => fileInput.click());

      // Handle file selection
      fileInput.addEventListener('change', () => {
        const file = fileInput.files && fileInput.files[0];
        if (!file) return;
        const reader = new FileReader();
        reader.onload = () => {
          editor.value = reader.result || '';
          filename.value = file.name || 'untitled.txt';
          try {
            localStorage.setItem(LS_KEY, editor.value);
            localStorage.setItem(LS_FILE, filename.value);
          } catch {}
          status.textContent = `Loaded \"${file.name}\" (${file.size} bytes)`;
        };
        reader.onerror = () => {
          status.textContent = 'Failed to read file';
        };
        reader.readAsText(file);
        // reset input so selecting the same file again triggers change
        fileInput.value = '';
      });

      // Keyboard shortcuts
      window.addEventListener('keydown', (e) => {
        const isMac = navigator.platform.toUpperCase().includes('MAC');
        const key = e.key.toLowerCase();
        if ((isMac ? e.metaKey : e.ctrlKey) && key === 's') {
          e.preventDefault();
          btnSave.click();
        }
        if ((isMac ? e.metaKey : e.ctrlKey) && key === 'o') {
          e.preventDefault();
          btnOpen.click();
        }
      });

      // Clear/New
      btnClear.addEventListener('click', () => {
        if (editor.value.trim() === '' || confirm('Clear the editor? This cannot be undone.')) {
          editor.value = '';
          editor.focus();
          status.textContent = 'New document';
        }
      });

      // Focus editor on load
      setTimeout(() => editor.focus(), 200);
    })();
  </script>
</body>
</html>
